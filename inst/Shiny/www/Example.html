<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="William H. Farmer" />

<meta name="date" content="2016-01-28" />

<title>Weighted-Multiple-Linear Regression (WREG, v. 1.05-02)</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Weighted-Multiple-Linear Regression (WREG, v. 1.05-02)</h1>
<h4 class="author"><em>William H. Farmer</em></h4>
<h4 class="date"><em>2016-01-28</em></h4>
</div>


<div id="introduction" class="section level2">
<h2>1 Introduction</h2>
<p>The Weighted-Multiple-Linear Regression (WREG) package has been developed to replicate the functionality of the U.S. Geological Surveyâ€™s standalone WREG program (1). The WREG program was deployed as a MatLab executable program and is operated exclusively through a graphical user interface. The WREG package is intended to provide an open-source resource for users wishing to apply the methods of the WREG program in a more accessible, adaptable and transparent environment using the R programming language. The package is provided for users with some familiarity with the R programming environment. For users who prefer a graphical user interface, this will be provided in a future release.</p>
<p>The WREG package and program are designed to help users develop regional regression equations relating streamflow frequency statistics to basin characteristics. In addition to ordinary least-squares, WREG implements hydrologic applications of weighted and generalized least-squares (2 and 3). The original manual for the WREG program (1) provides the necessary background and documentation of the WREG program and package. This vignette guides potential users through the basic workflows required to implement ordinary, weighted and genearlized least-squares regression.</p>
<div id="compatability-between-the-wreg-program-and-package" class="section level3">
<h3>1.1 Compatability between the WREG program and package</h3>
<p>In the development of the WREG package, several improvements on the WREG program were considered and implemented. Full documentation of improvements will be included in a revised manual. However, an option, <code>Legacy=TRUE</code> has been included to force the WREG package to return the same result as the WREG program. This is only include for testing, but may help transitioning users become comfortable with the validity of the new implementations.</p>
</div>
</div>
<div id="package-and-example-data" class="section level2">
<h2>2 Package and example data</h2>
<p>Once installed, the WREG package is loaded in the standard way:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(WREG)</code></pre>
<p>The package contains the same sample input files that are included with the deployment of version 1.05 of the WREG program. The input files have been condensed into list objects for easy manipulation and storage. The data can be loaded with the following command:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(baseData)</code></pre>
<p>The list object <code>baseData</code> contains the streamflow frequency statistics (oringally contained in FlowChar.txt), the independent variables (SiteInfo.txt) and the parameters of the fitted Log-Pearson Type III distributions (LP3G.txt, LP3K.txt, and LP3s.txt).</p>
<p>This example data set contains several dependent variables</p>
<pre><code>## [1] &quot;Q50.&quot; &quot;Q2.&quot;  &quot;Q1.&quot;</code></pre>
<p>and several independent variables</p>
<pre><code>## [1] &quot;DRNAREA&quot; &quot;LENGTH&quot;  &quot;BFI&quot;     &quot;ANNTAU&quot;  &quot;PRECIP&quot;  &quot;CLAY&quot;</code></pre>
<p>allowing users to explore additional regressions and transformations beyond the scope of this vignette.</p>
<p>The <code>baseData</code> list also contains a matrix of the record lengths at each site and concurrent record lengths. The WREG program derives these from analyzing the USGS########.txt files, but those have been pre-processed here. (The orginal site files can be accessed with <code>data(siteData)</code>.)</p>
</div>
<div id="ordinary-least-squares" class="section level2">
<h2>3 Ordinary least-squares</h2>
<p>Being the simplest form of regression implemented in the WREG package, ordinary least-squares regression reuires the fewest inputs into the main WREG function <code>WREG.MLR</code>. Only independet and dependent variables are required to implement ordinary least-squares regression.</p>
<p>For this vignette we will consider a regression of the 1% peak streamflow against drainage area and precipitation. We will fit a power-law regression, taking the natural logarithms of all independent and dependent variables. The following line of code prepares the dependent variable.</p>
<pre class="sourceCode r"><code class="sourceCode r">exY &lt;-<span class="st"> </span><span class="kw">log</span>(baseData$Dependent$Q1.)</code></pre>
<p>The independent variables are defined as</p>
<pre class="sourceCode r"><code class="sourceCode r">X1 &lt;-<span class="st"> </span><span class="kw">log</span>(baseData$Independent$DRNAREA)
X2 &lt;-<span class="st"> </span><span class="kw">log</span>(baseData$Independent$PRECIP)
X0 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(X1))
exX &lt;-<span class="st"> </span><span class="kw">cbind</span>(X0,X1,X2)</code></pre>
<p>Note that it is necessary to include the unit predictor in order to fit the leading coefficient or constant.</p>
<p>The WREG program provided a graphical user interface for the selection and transformation of variables. This task is executed at the command line before passing inputs to the WREG packageâ€™s main computational engine <code>WREG.MLR</code>. Once the dependent and independent varaibles are defined, they are merely passed to <code>WREG.MLR</code> with the <code>Reg</code> option set to <code>'OLS'</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">Ex.OLS &lt;-<span class="st"> </span><span class="kw">WREG.MLR</span>(<span class="dt">Y=</span>exY,<span class="dt">X=</span>exX,<span class="dt">Reg=</span><span class="st">'OLS'</span>)</code></pre>
<p>The resulting list object, <code>Ex.OLS</code> contains a wide array of outputs</p>
<pre><code>##  [1] &quot;Coefs&quot;              &quot;ResLevInf&quot;          &quot;LevLim&quot;            
##  [4] &quot;InflLim&quot;            &quot;LevInf.Sig&quot;         &quot;PerformanceMetrics&quot;
##  [7] &quot;X&quot;                  &quot;Y&quot;                  &quot;fitted.values&quot;     
## [10] &quot;residuals&quot;          &quot;Weighting&quot;          &quot;Inputs&quot;</code></pre>
<p>each of which is described in detail in the help file of <code>WREG.MLR</code>. The outputs of the WREG package are designed to be more comprehensive than the outputs of the WREG program.</p>
<p>The coefficients, and associated statistics thereof, are included in <code>Coefs</code></p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Coefficient</th>
<th align="right">Standard Error</th>
<th align="right">tStatistic</th>
<th align="right">pValue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X0</td>
<td align="right">-6.7853</td>
<td align="right">5.3894</td>
<td align="right">-1.2590</td>
<td align="right">0.2161</td>
</tr>
<tr class="even">
<td align="left">X1</td>
<td align="right">0.5132</td>
<td align="right">0.0486</td>
<td align="right">10.5625</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">X2</td>
<td align="right">3.7917</td>
<td align="right">1.5589</td>
<td align="right">2.4323</td>
<td align="right">0.0201</td>
</tr>
</tbody>
</table>
<p>Performance metrics are found in <code>PerformanceMetrics</code></p>
<table>
<thead>
<tr class="header">
<th align="right">MSE</th>
<th align="right">R2</th>
<th align="right">R2_adj</th>
<th align="right">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4543</td>
<td align="right">0.7768</td>
<td align="right">0.7644</td>
<td align="right">318.1372</td>
</tr>
</tbody>
</table>
<p>Though not presented here, the residuals, leverage and inlufence are found in <code>ResLevInf</code>.</p>
<p>These outputs can be used to create a wide range of performance plots for detailed analysis. Here are several plots mirroring the output of the WREG program. (It is important to remember that the units of the axes replicate the units of the dependent variable <code>Y</code>.)</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Ex.OLS$fitted.values,Ex.OLS$residuals,
  <span class="dt">main=</span><span class="st">'Residuals versus Estimated Flow Characteristics'</span>,
  <span class="dt">xlab=</span><span class="st">'Estimated Flow Characteristic'</span>,<span class="dt">ylab=</span><span class="st">'Residual'</span>,
  <span class="dt">xaxs=</span><span class="st">'i'</span>,<span class="dt">yaxs=</span><span class="st">'i'</span>,<span class="dt">ylim=</span><span class="kw">c</span>(-<span class="fl">1.5</span>,<span class="fl">1.5</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">4.5</span>,<span class="dv">10</span>))
<span class="kw">grid</span>(<span class="dt">nx=</span><span class="dv">11</span>,<span class="dt">ny=</span><span class="dv">6</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Ex.OLS$Y,Ex.OLS$ResLevInf$Leverage,
  <span class="dt">main=</span><span class="st">'Leverage Values versus Observations'</span>,
  <span class="dt">xlab=</span><span class="st">'Observation'</span>,<span class="dt">ylab=</span><span class="st">'Leverage Value'</span>,
  <span class="dt">xaxs=</span><span class="st">'i'</span>,<span class="dt">yaxs=</span><span class="st">'i'</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">11</span>))
<span class="kw">grid</span>(<span class="dt">nx=</span><span class="dv">6</span>,<span class="dt">ny=</span><span class="dv">6</span>)
<span class="kw">abline</span>(Ex.OLS$LevLim,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">'red'</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Ex.OLS$Y,Ex.OLS$ResLevInf$Influence,
  <span class="dt">main=</span><span class="st">'Influence Value versus Observation'</span>,
  <span class="dt">xlab=</span><span class="st">'Observation'</span>,<span class="dt">ylab=</span><span class="st">'Influence Value'</span>,
  <span class="dt">xaxs=</span><span class="st">'i'</span>,<span class="dt">yaxs=</span><span class="st">'i'</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.14</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">11</span>))
<span class="kw">grid</span>(<span class="dt">nx=</span><span class="dv">6</span>,<span class="dt">ny=</span><span class="dv">7</span>)
<span class="kw">abline</span>(Ex.OLS$InflLim,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">'red'</span>)</code></pre>
</div>
<div id="weighted-least-squares" class="section level2">
<h2>4 Weighted Least-Squares</h2>
<p>With a few additional inputs, <code>WREG.MLR</code> can apply weighted least-squares regression as defined by (2). In order to compute weights, the function requires information about record lengths and the fitted Log-Pearson Type III distribution.</p>
<p>Example record lengths are included in the example data set:</p>
<pre class="sourceCode r"><code class="sourceCode r">RL &lt;-<span class="st"> </span>baseData$RecordLengths</code></pre>
<p>The example record lengths include the concurrent record lengths, resulting in a matrix. A vector of record lengths, ignoring the concurrent records, is obtained with <code>diag(RL)</code>; if a matrix is passed to <code>WREG.MLR</code> when <code>Reg='WLS'</code>, requesting weighted least-squares, then the diagnoal is extracted automatically.</p>
<p>In addition to record lengths, the weighting designed by (2) requires information on the fitted Log-Pearson Type III distribution. The three parameters, the standard deviation, deviates and skew, are passed as a list to <code>WREG.MLR</code>. The example files contain the LP3 parameters for each dependent variable, so the following code extracts those realted to the 1% event.</p>
<pre class="sourceCode r"><code class="sourceCode r">exLP3 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">S=</span>baseData$LP3$S$s<span class="fl">.1</span>.,<span class="dt">K=</span>baseData$LP3$K$K<span class="fl">.50</span>.,<span class="dt">G=</span>baseData$LP3$G$Skew50.)</code></pre>
<p>With these inputs, it is then possible to compute the coefficients based on the weight least-squares algorithm:</p>
<pre class="sourceCode r"><code class="sourceCode r">Ex.WLS &lt;-<span class="st"> </span><span class="kw">WREG.MLR</span>(<span class="dt">Y=</span>exY,<span class="dt">X=</span>exX,<span class="dt">Reg=</span><span class="st">'WLS'</span>,<span class="dt">RecordLengths=</span>RL,<span class="dt">LP3=</span>exLP3)</code></pre>
<p>The new coefficients are</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Coefficient</th>
<th align="right">Standard Error</th>
<th align="right">tStatistic</th>
<th align="right">pValue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X0</td>
<td align="right">-6.7709</td>
<td align="right">5.3880</td>
<td align="right">-1.2567</td>
<td align="right">0.2170</td>
</tr>
<tr class="even">
<td align="left">X1</td>
<td align="right">0.5131</td>
<td align="right">0.0485</td>
<td align="right">10.5690</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">X2</td>
<td align="right">3.7876</td>
<td align="right">1.5585</td>
<td align="right">2.4303</td>
<td align="right">0.0202</td>
</tr>
</tbody>
</table>
<p>The application of weighted least-squared regression produces a range of new performance metrics,</p>
<pre><code>##  [1] &quot;MSE&quot;        &quot;R2&quot;         &quot;R2_adj&quot;     &quot;RMSE&quot;       &quot;R2_pseudo&quot; 
##  [6] &quot;AVP&quot;        &quot;Sp&quot;         &quot;VP.PredVar&quot; &quot;ModErrVar&quot;  &quot;StanModErr&quot;</code></pre>
</div>
<div id="generalized-least-squares" class="section level2">
<h2>5 Generalized Least-Squares</h2>
<p>The final form of regression implemented in the WREG package is the hydrologic interpretation of generalized least-squares regression developed by (3). This application of generalized least-squares regression relies on an approximation of cross correlation based on inter-site distances. With this approximation, generalized least-squares regression can be applied with or without uncertainty in regional skew.</p>
<p>First we need to collect station IDs and latitude-longitude couplets.</p>
<pre class="sourceCode r"><code class="sourceCode r">descBasin &lt;-<span class="st"> </span>baseData$Independent[,<span class="dv">1</span>:<span class="dv">3</span>]
<span class="kw">names</span>(descBasin)</code></pre>
<pre><code>## [1] &quot;Station.ID&quot; &quot;Lat&quot;        &quot;Long&quot;</code></pre>
<p>These basin characteristics are used to either assess the fit of estimated cross-correlation or apply generalized least-squares regression.</p>
<div id="estimated-cross-correlation" class="section level3">
<h3>5.1 Estimated cross-correlation</h3>
<p>The WREG program provides a graphical user interface in order to determine a relationship between distance and correlation. In the WREG package, the function <code>testXCorr</code> can be used to undertake the same exploration. Site data, like that provided in <code>siteData</code> are needed to assess model fits.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(siteData)</code></pre>
<p>By manually varying the <code>alpha</code>, <code>theta</code> and <code>concurrentMin</code>, one can assess the fitted estimates. The model can also be fit using two separate calculations of distances: the WREG program uses a nautical-mile approximation, while â€˜DistMeth=2â€™ applies the Haversine formula.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">testXCorr</span>(<span class="dt">siteData=</span>siteData,<span class="dt">BasinChars=</span>descBasin,<span class="dt">alpha=</span><span class="fl">0.002</span>,<span class="dt">theta=</span><span class="fl">0.98</span>,<span class="dt">DistMeth=</span><span class="dv">2</span>,
  <span class="dt">concurrentMin=</span><span class="dv">25</span>,<span class="dt">plot=</span><span class="ot">TRUE</span>)</code></pre>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
</div>
<div id="without-uncertainty-in-skew" class="section level3">
<h3>5.2 Without uncertainty in skew</h3>
<p>Once <code>alpha</code> and <code>theta</code> have been selected, it is possible to fit a model using genearlized least-squares.</p>
<pre class="sourceCode r"><code class="sourceCode r">Ex.GLS &lt;-<span class="st"> </span><span class="kw">WREG.MLR</span>(<span class="dt">Y=</span>exY,<span class="dt">X=</span>exX,<span class="dt">Reg=</span><span class="st">'GLS'</span>,<span class="dt">RecordLengths=</span>RL,<span class="dt">LP3=</span>exLP3,
                     <span class="dt">BasinChars=</span>descBasin,<span class="dt">alpha=</span><span class="fl">0.002</span>,<span class="dt">theta=</span><span class="fl">0.98</span>,<span class="dt">DistMeth=</span><span class="dv">2</span>)</code></pre>
<p>The new coefficients are</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Coefficient</th>
<th align="right">Standard Error</th>
<th align="right">tStatistic</th>
<th align="right">pValue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X0</td>
<td align="right">-6.6168</td>
<td align="right">5.4364</td>
<td align="right">-1.2171</td>
<td align="right">0.2315</td>
</tr>
<tr class="even">
<td align="left">X1</td>
<td align="right">0.5132</td>
<td align="right">0.0484</td>
<td align="right">10.5932</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">X2</td>
<td align="right">3.7422</td>
<td align="right">1.5727</td>
<td align="right">2.3794</td>
<td align="right">0.0228</td>
</tr>
</tbody>
</table>
<p>The same perfromance metrics calculated when appolying wegihted least-squares regression are calculated when computing generalized least-squares regression.</p>
</div>
<div id="uncertainty-in-skew" class="section level3">
<h3>5.3 Uncertainty in skew</h3>
<p>In addition to the generalized least-squares developed by (3), the WREG package is capable of implementing the correction for regional uncertainty developed by (4). When requesting the skew-correction, <code>Reg='GLSskew'</code>, it is necessary to include several additional parameters:</p>
<ul>
<li><code>MSEGR</code> : The mean-squared-error of the regional skew</li>
<li><code>TY</code> : The return period of the streamflow frequency statistic</li>
<li><code>Peak</code> : A logical value indicating if the event is a peak event (<code>TRUE</code>) or a low event (<code>FALSE</code>)</li>
</ul>
<p>It is also necessary to add the regional skew value to the LP3 list:</p>
<pre class="sourceCode r"><code class="sourceCode r">exLP3$GR &lt;-<span class="st"> </span>baseData$Independent$Regional.Skew</code></pre>
<p>Applying generalized least-squares regression with a correction for uncertainty in regional skew</p>
<pre class="sourceCode r"><code class="sourceCode r">Ex.GLSs &lt;-<span class="st"> </span><span class="kw">WREG.MLR</span>(<span class="dt">Y=</span>exY,<span class="dt">X=</span>exX,<span class="dt">Reg=</span><span class="st">'GLSskew'</span>,<span class="dt">RecordLengths=</span>RL,<span class="dt">LP3=</span>exLP3,
  <span class="dt">BasinChars=</span>descBasin,<span class="dt">alpha=</span><span class="fl">0.002</span>,<span class="dt">theta=</span><span class="fl">0.98</span>,<span class="dt">DistMeth=</span><span class="dv">2</span>,
  <span class="dt">MSEGR=</span><span class="fl">0.302</span>,<span class="dt">TY=</span><span class="dv">100</span>,<span class="dt">Peak=</span><span class="ot">TRUE</span>)</code></pre>
<p>produces a new set of coefficients</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Coefficient</th>
<th align="right">Standard Error</th>
<th align="right">tStatistic</th>
<th align="right">pValue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X0</td>
<td align="right">-6.6519</td>
<td align="right">5.4457</td>
<td align="right">-1.2215</td>
<td align="right">0.2298</td>
</tr>
<tr class="even">
<td align="left">X1</td>
<td align="right">0.5133</td>
<td align="right">0.0484</td>
<td align="right">10.5962</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">X2</td>
<td align="right">3.7522</td>
<td align="right">1.5753</td>
<td align="right">2.3819</td>
<td align="right">0.0226</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="region-of-influence-regression" class="section level2">
<h2>6 Region-of-influence regression</h2>
<p>The WREG program is also capable of applying region-of-influence regression, calculating coefficients by any of the methods previously discussed. This same functionality is replicated in the WREG package using the <code>WREG.RoI</code> function. This vignette will not explore the application of region-of-influence regression, but the associated help files may provide the guidance needed. Naturally, applying region-of-influence produces several unique outputs; again, the help files provide descriptions.</p>
</div>
<div id="references" class="section level2">
<h2>7 References</h2>
<ol style="list-style-type: decimal">
<li>Eng, K., Chen, Y., and Kiang, J.E., 2009, Userâ€™s guide to the weighted-multiple-linear-regression program (WREG version 1.0): U.S. Geological Survey Techniques and Methods, book 4, chap. A8, 21 p.</li>
<li>Tasker, G.D., 1980, Hydrologic regression with weighted least squares: Water Resources Research, v. 16, no. 6, p.Â 1107-1113.</li>
<li>Stedinger, J.R, and Tasker, G.D., 1985, Regional hydrologic analysis, 1, ordinary, weighted, and generalized least squares compared: Water Resources Research, v. 21, no. 9, p.Â 1421-1432.</li>
<li>Griffis, V.W., and Stedinger, J.R., 2007, The use of GLS regression in regional hydrologic analyses: Journal of Hydrology, v. 344, p.Â 82-95.</li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
